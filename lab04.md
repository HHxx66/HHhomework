# 字符编码有关知识

**ASCII码**

说到字符编码，不得不说ASCII码的简史。计算机一开始发明的时候是用来解决数字计算的问题，后来人们发现，计算机还可以做更多的事，例如文本处理。但由于计算机只识“数”，因此人们必须告诉计算机哪个数字来代表哪个特定字符，例如65代表字母‘A’，66代表字母‘B’，以此类推。但是计算机之间字符-数字的对应关系必须得一致，否则就会造成同一段数字在不同计算机上显示出来的字符不一样。因此美国国家标准协会ANSI制定了一个标准，规定了常用字符的集合以及每个字符对应的编号，这就是ASCII字符集（Character Set），也称ASCII码。

由于当时用到的字符相对较少，7个比特位就可以高效的存储和处理ASCII码，因此当时的最高一位通常用为一些通讯系统的奇偶校验。

![](http://www.techug.com/wordpress/wp-content/uploads/2014/07/63918611gw1eimi3h2z56j207m042mxl.jpg)

**OEM字符集**

当计算机开始发展起来的时候，人们逐渐发现，ASCII字符集里那可怜的128个字符已经不能再满足他们的需求了。人们就在想，一个字节能够表示的数字（编号）有256个，而ASCII字符只用到了0×00~0x7F，也就是占用了前128个，后面128个数字不用白不用，因此很多人打起了后面这128个数字的主意。可是问题在于，很多人同时有这样的想法，但是大家对于0×80-0xFF这后面的128个数字分别对应什么样的字符，却有各自的想法。这就导致了当时销往世界各地的机器上出现了大量各式各样的OEM字符集。

![](http://www.techug.com/wordpress/wp-content/uploads/2014/07/63918611gw1eimi3hkiihj207j05tt9n.jpg)

事实上，大部分OEM字符集是兼容ASCII字符集的，也就是说，大家对于0×00~0x7F这个范围的解释基本是相同的，而对于后半部分0×80~0xFF的解释却不一定相同,甚至有时候同样的字符在不同OEM字符集中对应的字节也是不同的,因此导致了人们无法跨机器交流各种文档的问题。

**多字节字符集（MBCS）和中文字符集**

先前的编码方式都是一个字节的，这对于某些国家来说是足够的，但是对与另一些国家或许是不够的，譬如我们中国。庞大的汉字要全部编码的话显然一个字节是远远不足的，为了用上电脑，又要保持和ASCII字符集的兼容，所以就发明了多字节编码方式，相应的字符集就称为多字节字符集。例如我们中国使用的就是双字节字符集编码（DBCS，Double Byte Character Set）。

而对于多字节字符集，代码页中通常会有很多码表。那么程序怎么知道该使用哪张码表去解码二进制流呢？答案是，根据第一个字节来选择不同的码表进行解析。

例如目前最常用的中文字符集GB2312，涵盖了所有简体字符以及一部分其他字符；GBK（K代表扩展的意思）则在GB2312的基础上加入了对繁体字符等其他非简体字符。这两个字符集的字符都是使用1-2个字节来表示。Windows系统采用936代码页来实现对GBK字符集的编解码。在解析字节流的时候，如果遇到字节的最高位是0的话，那么就使用936代码页中的第1张码表进行解码，这就和单字节字符集的编解码方式一致了。

![](http://www.techug.com/wordpress/wp-content/uploads/2014/07/63918611gw1eimi3ikuc2j20bk08hq4h.jpg)

当字节的高位是1的时候，确切的说，当第一个字节位于0x81–0xFE之间时，根据第一个字节不同找到代码页中的相应的码表，例如当第一个字节是0x81，那么对应936中的下面这张码表：

![](http://www.techug.com/wordpress/wp-content/uploads/2014/07/63918611gw1eimi3jdgnmj20ca0ae40i.jpg)

**ANSI标准、国家标准、ISO标准**

前面说到人们无法跨机器交流各种文档的问题,为解决这个问题各种组织便陆续进行了标准化流程。例如美国ANSI组织制定了ANSI标准字符编码（注意，我们现在通常说到ANSI编码，通常指的是平台的默认编码，例如英文操作系统中是ISO-8859-1，中文系统是GBK），ISO组织制定的各种ISO标准字符编码，还有各国也会制定一些国家标准字符集，例如中国的GBK，GB2312和GB18030。

操作系统在发布的时候，通常会往机器里预装这些标准的字符集还有平台专用的字符集，这样只要你的文档是使用标准字符集编写的，通用性就比较高了。例如你用GB2312字符集编写的文档，在中国大陆内的任何机器上都能正确显示。同时，我们也可以在一台机器上阅读多个国家不同语言的文档了，前提是本机必须安装该文档使用的字符集。

**Unicode**

虽然通过使用不同字符集，我们可以在一台机器上查阅不同语言的文档，但是我们仍然无法解决一个问题：在一份文档中显示所有字符。为了解决这个问题，我们需要一个全人类达成共识的巨大的字符集，这就是Unicode字符集。

Unicode字符集涵盖了目前人类使用的所有字符，并为每个字符进行统一编号，分配唯一的字符码（Code Point）。Unicode字符集将所有字符按照使用上的频繁度划分为17个层面（Plane），每个层面上有2<sup>16</sup>=65536个字符码空间。

![](http://www.techug.com/wordpress/wp-content/uploads/2014/07/63918611gw1eimi3k24a3j20fg068gme.jpg)

常见的Unicode编码有UCS-2/UTF-16和UTF-8，其中UTF-8应该是目前应用最广泛的编码方式了。